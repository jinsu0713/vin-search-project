<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIN ê²€ìƒ‰ ê°¤ëŸ¬ë¦¬</title>
    <style>
        /* ê¸°ë³¸ì ì¸ UI ìŠ¤íƒ€ì¼ (ì´ì „ì— ì‚¬ì§„ì—ì„œ ë³¸ ë””ìì¸ì„ ì¬í˜„í•©ë‹ˆë‹¤) */
        body { 
            font-family: Arial, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding-top: 50px; 
            background-color: #f8f9fa;
        }
        h1 { color: #343a40; }
        .search-box { 
            background-color: #ffffff; 
            padding: 40px; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); 
            text-align: center;
            margin-top: 20px;
        }
        h2 { margin-top: 0; color: #495057; }
        input[type="text"] { 
            padding: 12px; 
            border: 1px solid #ced4da; 
            border-radius: 6px; 
            width: 300px; 
            margin-right: 10px; 
            font-size: 16px;
        }
        button { 
            padding: 12px 25px; 
            background-color: #007bff; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover { 
            background-color: #0056b3; 
        }
        #result-area { 
            margin-top: 40px; 
            font-size: 1.1em; 
            text-align: center;
        }
        .error { 
            color: #dc3545; 
            font-weight: bold;
        }
        .success-message { 
            color: #28a745; 
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <h1>My Car Photo at Incheon port, Korea ğŸš¢ğŸš—ğŸ‡°ğŸ‡·</h1>
    <p>Enter the last 8 or full 17 digits of the VIN.</p>

    <div class="search-box">
        <h2>What is the VIN of your car?</h2>
        <input type="text" id="vinInput" placeholder="Last 8 or Full 17 VIN digits" maxlength="17">
        <button onclick="searchVin()">Search</button>
    </div>

    <div id="result-area"></div>

    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>

    <script>
        // 2. â­ Firebase í”„ë¡œì íŠ¸ ì„¤ì • ì •ë³´ (ë°˜ë“œì‹œ ë³¸ì¸ì˜ ì •ë³´ë¡œ êµì²´) â­
        // ì´ ì •ë³´ëŠ” í”„ë¡œì íŠ¸ ì„¤ì •(í†±ë‹ˆë°”í€´) > ë‚´ ì•± > ì›¹ ì•±ì—ì„œ ë³µì‚¬í•œ ê°’ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
        const firebaseConfig = {
            apiKey: "AIzaSyDVLHzfiCympwulbFHUC9A1KAJ608ekX6Q",
            authDomain: "photo2-352bf.firebaseapp.com",
            projectId: "photo2-352bf",
            storageBucket: "photo2-352bf.appspot.com",
            messagingSenderId: "683476388610",
            appId: "1:683476388610:web:67f117489236ff3900c701b",
            // measurementId: "G-Z6Q9XJFJ7D" // AnalyticsëŠ” í•„ìˆ˜ê°€ ì•„ë‹ˆë¯€ë¡œ ìƒëµ ê°€ëŠ¥
        };

        // Firebase ì´ˆê¸°í™”
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const carsRef = db.collection("cars"); // VIN ë°ì´í„°ê°€ ì €ì¥ëœ ì»¬ë ‰ì…˜ ì´ë¦„

        /**
         * VINì„ ê²€ìƒ‰í•˜ê³  Firestoreì—ì„œ ì•¨ë²” URLì„ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜
         */
        async function searchVin() {
            const vin = document.getElementById('vinInput').value.trim();
            const resultArea = document.getElementById('result-area');
            resultArea.innerHTML = '<p style="color: #007bff;">ğŸ” Searching...</p>';

            if (!vin) {
                resultArea.innerHTML = '<p class="error">VIN ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.</p>';
                return;
            }

            try {
                // Firestoreì—ì„œ VIN(Document ID)ìœ¼ë¡œ ì§ì ‘ ì¡°íšŒ
                const doc = await carsRef.doc(vin).get();

                if (doc.exists) {
                    const url = doc.data().albumUrl;
                    
                    if (url) {
                         resultArea.innerHTML = `
                            <p class="success-message">âœ… VIN **${vin}** ì— ëŒ€í•œ ì•¨ë²”ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤!</p>
                            <p>
                                <a href="${url}" target="_blank" style="color: #007bff; font-weight: bold; text-decoration: none;">â¡ï¸ Google í¬í†  ì•¨ë²” ë°”ë¡œê°€ê¸°</a>
                            </p>
                        `;
                    } else {
                         resultArea.innerHTML = `<p class="error">âŒ ì˜¤ë¥˜: ì•¨ë²” URL ë°ì´í„°ê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.</p>`;
                    }
                   
                } else {
                    resultArea.innerHTML = `<p class="error">âŒ ì˜¤ë¥˜: VIN **${vin}** ì— í•´ë‹¹í•˜ëŠ” ì°¨ëŸ‰ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>`;
                }
            } catch (error) {
                console.error("Firestore Error:", error);
                resultArea.innerHTML = `<p class="error">ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (Consoleì„ í™•ì¸í•˜ì„¸ìš”)</p>`;
            }
        }
    </script>
</body>
</html>